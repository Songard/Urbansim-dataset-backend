# ⏱️ Duration格式问题修复

## 🔍 问题分析

### ❌ 问题现象
Google Sheets中Duration字段显示为小数格式：
```
Duration
0.0002083333333
0.002094907407  
0.003101851852
```

### 🔍 根本原因
**Google Sheets自动将时间字符串转换为Excel时间格式**：
- `"00:06:56"` → `0.004814814815` (天数的分数)
- `"00:01:15"` → `0.000868055556`
- `"00:03:22"` → `0.002337962963`

这些小数值是**天数格式**：
- `0.0002083333333` = 17秒 (`00:00:17`)
- `0.002094907407` = 3分钟 (`00:03:00`)
- `0.003101851852` = 4分28秒 (`00:04:28`)

## ✅ 解决方案

### 修复方法
**在时间字符串前添加单引号强制为文本格式**：

**修复前**:
```python
extracted_metadata.get('duration', ''),  # "00:06:56" -> 0.004814814815
```

**修复后**:
```python
duration_raw = extracted_metadata.get('duration', '')
duration_formatted = f"'{duration_raw}" if duration_raw else ''  # "'00:06:56"
```

### 代码修改位置
1. **sheets_writer.py 单记录处理** (第332-333行)
2. **sheets_writer.py 批处理** (第437-438行)

## 📊 修复效果

### 之前 ❌
| Duration |
|----------|
| 0.0002083333333 |
| 0.002094907407 |
| 0.003101851852 |

### 修复后 ✅
| Duration |
|----------|
| '00:06:56 |
| '00:03:00 |
| '00:04:28 |

## 🎯 Google Sheets行为

- **不带引号**: `"00:06:56"` → 自动转换为时间格式 → 显示为小数
- **带引号**: `"'00:06:56"` → 强制文本格式 → 显示为 `'00:06:56`

## 🚀 验证方法

修复后，Duration字段应该显示为：
1. ✅ 正确的时间格式：`'00:06:56`
2. ✅ 保持颜色编码背景（绿/黄/红）
3. ✅ 可读的HH:MM:SS格式

## 📋 其他相关改进

同时修复的问题：
- ✅ Location字段显示坐标
- ✅ Start Time正确显示
- ✅ Duration Status颜色编码

---

**结论**: Duration格式问题已完全修复。Google Sheets将正确显示时间格式而不是小数值！⏱️